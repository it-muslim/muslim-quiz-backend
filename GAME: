AUTH:
###########
/auth
request body
{
    email
    password
}



GAME:

###########
/invite_user_to_game
header body
{
	auth-token:
}
request body
{
	user
}

initiator = request body -> user_id
user_id = request body -> user_id

game = dbStore.games.create_with_autoId
game.user = initiator
game.partner = user


###########
/accept_invitiation_to_game
header body
{
	auth-token:
}
request body
{
	game_id
}

game_id = request body -> game_id

game = dbStore.games(game_id)
game.stardDate = Date()
user1 = game.user
user2 = game.partner
game.roundes = generateRounds([user1, user2])


###########
/start_dame
header body
{
	auth-token:
}
request body
{
	game_id
	round_id
}

user_id = header body -> user_id
round_id = request body -> round_id

round = dbStore.rounds(round_id)
round.users(user_id).startDate = Date()
// schedule a callback on round time expiration?

###########
/answer_quiz
header body
{
	auth-token:
}
request body
{
	game_id
	round_id
	answer_id
}

game_id = request body -> user_id
round_id = request body -> round_id
answer_id = request body -> answer_id

game = dbStore.games(game_id)
round = dbStore.rounds(round_id)

quiz = round.quiz
answers = quiz.questions.answers

roundUserInfo = round.roundUserInfo
roundUserInfo.quiz(quiz.id).answer = answer_id
isCorrect = ifCorrect(answer_id, answers)
roundUserInfo.score = calculateScore(...)

isQuestionLast = quiz.questions.last == quiz.id
if (isQuestionLast)
	roundUserInfo.endDate = Date()

isRoundLast = game.rounds.last == round_id
if (partnetFinished && isRoundLast):
	game.endDate = Date()


###########
/give_up
header body
{
	auth-token:
}
request body
{
	game_id
}

user_id = header body -> user_id
game_id = request body -> user_id

game = dbStore.games(game_id)
game.endDate = Date()
game.rounds.each {
	round.users(user_id).isGivenUp = true
	round.endDate = Date()
}


###########
/games
header body
{
	auth-token:
}
request body
{
	completed
}

completed = request body -> completed
initiator = request body -> user_id
games = dbStore.games.filted(intiator, completed)



ROUND:

generateRounds(users):
	for i in 0..roundCount:
		round = dbStore.rounds.create_with_autoId
		excluded_quizes = users.map { return user.quiz }
		round.quiz = generateQuiz(excluded_quizes)
		round.users.add(users)

generateQuiz(excluded_quizes)
	quizes = dbStore.quizes.get_random(excluded_quizes)


isCorrect = ifCorrect(answer_id, answers):
	return answers.first.id == answer_id

calculateScore(...):

partnetFinished(...)